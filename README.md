# Portfolio Homepage

ç§ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚BFFï¼ˆBackend for Frontendï¼‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã€Cloudflare Workersã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã¾ã™ã€‚

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare Edge Network                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Web Worker (home)    â”‚      â”‚  API Worker          â”‚  â”‚
â”‚  â”‚   Next.js 16 + OpenNextâ”‚â—„â”€â”€â”€â”€â–ºâ”‚  (portfolio-api)     â”‚  â”‚
â”‚  â”‚                        â”‚      â”‚  Hono.js             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                                â”‚                 â”‚
â”‚           â”‚                                â”‚                 â”‚
â”‚           â–¼                                â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  R2 Bucket             â”‚      â”‚  External APIs       â”‚  â”‚
â”‚  â”‚  (ISR Cache)           â”‚      â”‚  - GitHub API        â”‚  â”‚
â”‚  â”‚  next-cache-bucket     â”‚      â”‚  - Qiita API         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  - Zenn API          â”‚  â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²
         â”‚
    User Access
```

### é€šä¿¡ãƒ•ãƒ­ãƒ¼

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†’ Web Worker**: ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒšãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
2. **Web Worker â†’ API Worker**: Service Bindingã‚’ä½¿ç”¨ã—ãŸå†…éƒ¨Workeré–“é€šä¿¡ï¼ˆèªè¨¼ä»˜ãï¼‰
3. **API Worker â†’ External APIs**: GitHub/Qiita/Zenn APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
4. **API Worker â†’ Web Worker**: JSONå½¢å¼ã§ãƒ‡ãƒ¼ã‚¿è¿”å´
5. **Web Worker â†’ R2 Bucket**: ISRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ä¿å­˜ãƒ»å–å¾—
6. **Web Worker â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸHTMLã‚’è¿”å´

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### **ãƒ¢ãƒãƒ¬ãƒç®¡ç†**
- **Turborepo**: ã‚¿ã‚¹ã‚¯ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **npm workspaces**: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†

#### **Backend (API Worker)**
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| **Hono.js** | 4.x | è»½é‡ãƒ»é«˜é€ŸãªWeb API ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| **TypeScript** | 5.x | å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ |
| **Cloudflare Workers** | - | ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç’°å¢ƒ |
| **Zod** | 3.x | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å‹æ¨è«– |

#### **Frontend (Web Worker)**
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| **Next.js** | 16.x | Reactãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆApp Routerï¼‰ |
| **React** | 19.x | UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| **OpenNext** | 1.x | Next.js â†’ Cloudflare Workerså¤‰æ› |
| **Hono Client** | 4.x | å‹å®‰å…¨ãªRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ |
| **TailwindCSS** | 3.x | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSS |
| **Radix UI** | - | ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| **TypeScript** | 5.x | å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ |

#### **å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**
- **@my-portfolio/shared**: å‹å®šç¾©ã®å…±æœ‰ï¼ˆArticle, GitHub Repositoryç­‰ï¼‰

#### **ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤**
| æŠ€è¡“ | ç”¨é€” |
|------|------|
| **Cloudflare Workers** | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| **Cloudflare R2** | ISRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| **Service Binding** | Workeré–“ã®å†…éƒ¨é€šä¿¡ |
| **GitHub Actions** | CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ |
| **Wrangler** | Cloudflareãƒ‡ãƒ—ãƒ­ã‚¤ãƒ„ãƒ¼ãƒ« |

### ä¸»è¦æ©Ÿèƒ½

#### **ISR (Incremental Static Regeneration)**
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœŸé–“**: 1æ™‚é–“ï¼ˆ3600ç§’ï¼‰
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Cloudflare R2ãƒã‚±ãƒƒãƒˆ
- **å¯¾è±¡ãƒ‡ãƒ¼ã‚¿**:
  - Qiita/Zennè¨˜äº‹ä¸€è¦§
  - GitHub ãƒªãƒã‚¸ãƒˆãƒªä¸€è¦§

#### **Service Binding (Workeré–“é€šä¿¡)**
- **èªè¨¼æ–¹å¼**: `X-Internal-API-Key` ãƒ˜ãƒƒãƒ€ãƒ¼
- **ãƒ¡ãƒªãƒƒãƒˆ**:
  - ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’çµŒç”±ã—ãªã„é«˜é€Ÿé€šä¿¡
  - ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼å‰Šæ¸›
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š

#### **BFF (Backend for Frontend)**
- **å½¹å‰²**:
  - è¤‡æ•°ã®å¤–éƒ¨APIã‚’é›†ç´„
  - ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  - èªè¨¼æƒ…å ±ã®éš è”½

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
.
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/                    # Backend Worker (Hono.js)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts        # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/         # API ãƒ«ãƒ¼ãƒˆå®šç¾©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ articles.ts # è¨˜äº‹APIï¼ˆQiita/Zennï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ github.ts   # GitHub API
â”‚   â”‚   â”‚   â””â”€â”€ middleware/     # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â”œâ”€â”€ wrangler.jsonc      # Cloudflare Workersè¨­å®š
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ web/                    # Frontend Worker (Next.js + OpenNext)
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ app/            # App Router
â”‚       â”‚   â”‚   â”œâ”€â”€ page.tsx    # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚       â”‚   â”‚   â””â”€â”€ layout.tsx  # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚       â”‚   â”œâ”€â”€ features/       # æ©Ÿèƒ½åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚       â”‚   â”‚   â”œâ”€â”€ show-article-list/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ api/    # APIå‘¼ã³å‡ºã—ãƒ­ã‚¸ãƒƒã‚¯
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ui/     # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚       â”‚   â”‚   â””â”€â”€ show-github-repository/
â”‚       â”‚   â”œâ”€â”€ lib/
â”‚       â”‚   â”‚   â””â”€â”€ api-client.ts  # Hono RPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚       â”‚   â””â”€â”€ config/         # ç’°å¢ƒå¤‰æ•°ç®¡ç†
â”‚       â”œâ”€â”€ wrangler.jsonc      # Cloudflare Workersè¨­å®š
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ shared/                 # å…±æœ‰å‹å®šç¾©
â”‚       â”œâ”€â”€ src/types/
â”‚       â”‚   â”œâ”€â”€ article.ts      # è¨˜äº‹å‹å®šç¾©
â”‚       â”‚   â””â”€â”€ github.ts       # GitHubå‹å®šç¾©
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ deploy.yml              # CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
â”‚
â”œâ”€â”€ turbo.json                  # Turborepoè¨­å®š
â””â”€â”€ package.json                # ãƒ«ãƒ¼ãƒˆpackage.json
```

## CI/CD ã®æ³¨æ„ç‚¹

### Wrangler OpenNext èª¤æ¤œå‡ºã®å›é¿

ãƒ¢ãƒãƒ¬ãƒç’°å¢ƒã§ã¯ã€Wrangler ãŒ `node_modules/@opennextjs/cloudflare` ã®å­˜åœ¨ã‚’æ¤œå‡ºã—ã¦ã€ã™ã¹ã¦ã®Workerã‚’OpenNextãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ‰±ãŠã†ã¨ã™ã‚‹å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

**å•é¡Œ**:
- `apps/api` ã¯ç´”ç²‹ãª Hono Worker ã§ã™ãŒã€ãƒ«ãƒ¼ãƒˆã® `node_modules/@opennextjs` ã‚’å‚ç…§ã—ã¦ OpenNext ã¨ã—ã¦èª¤æ¤œå‡ºã•ã‚Œã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: `"OpenNext project detected, calling 'opennextjs-cloudflare deploy'"`

**å›é¿ç­–** (`.github/workflows/deploy.yml` ã§å®Ÿè£…æ¸ˆã¿):
```yaml
# API ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã« @opennextjs ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä¸€æ™‚çš„ã«éš ã™
- name: Temporarily hide OpenNext package from API
  run: |
    if [ -d "node_modules/@opennextjs" ]; then
      mv node_modules/@opennextjs node_modules/@opennextjs-hidden
    fi

# ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«å¾©å…ƒ
- name: Restore OpenNext package
  if: always()
  run: |
    if [ -d "node_modules/@opennextjs-hidden" ]; then
      mv node_modules/@opennextjs-hidden node_modules/@opennextjs
    fi
```

**å‚è€ƒæƒ…å ±**:
- [Cloudflare Workers SDK](https://github.com/cloudflare/workers-sdk)
- [OpenNext Cloudflare](https://opennext.js.org/cloudflare)
- Wrangler ã®æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ã«é–¢ã™ã‚‹å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å­˜åœ¨ã§åˆ¤å®šã—ã¦ã„ã‚‹ã¨æ¨æ¸¬

### ãƒ“ãƒ«ãƒ‰æ™‚ã® API å‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼ã®å›é¿

Next.js ã® ISRï¼ˆIncremental Static Regenerationï¼‰ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ãƒ“ãƒ«ãƒ‰æ™‚ã«ã¯ API ã‚µãƒ¼ãƒãƒ¼ãŒå­˜åœ¨ã—ãªã„ãŸã‚ `ECONNREFUSED` ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

**å•é¡Œ**:
```
Error: Failed to collect page data for /
[cause]: TypeError: Invalid URL
  code: 'ERR_INVALID_URL',
  input: 'undefined'
```

**è§£æ±ºç­–** (`apps/web/src/features/*/api/*.ts` ã¨ `apps/web/src/lib/api-client.ts` ã§å®Ÿè£…æ¸ˆã¿):

1. **APIå‘¼ã³å‡ºã—å‰ã®æ¡ä»¶åˆ†å²**:
```typescript
// ãƒ“ãƒ«ãƒ‰æ™‚ã¯ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ï¼ˆINTERNAL_API_KEYãŒãªã„ = ãƒ“ãƒ«ãƒ‰æ™‚ï¼‰
if (!process.env.INTERNAL_API_KEY) {
  console.log('Build time: Returning empty array');
  return [];
}
```

2. **ãƒ€ãƒŸãƒ¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¿”å´**:
```typescript
// api-client.ts
export function createApiClient(env: Env): ReturnType<typeof hc<AppType>> {
  // ãƒ“ãƒ«ãƒ‰æ™‚: INTERNAL_API_KEYãŒç©ºã®å ´åˆã¯ãƒ€ãƒŸãƒ¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’è¿”ã™
  if (!env.INTERNAL_API_KEY) {
    return hc<AppType>("http://localhost:8787", {
      headers: { "X-Internal-API-Key": "" },
    });
  }
  // ... é€šå¸¸ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆå‡¦ç†
}
```

3. **ç’°å¢ƒå¤‰æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š**:
```typescript
// config/index.ts
export const NEXT_PUBLIC_BASE_URL = process.env.NEXT_PUBLIC_BASE_URL || 'https://t2fox.pages.dev';
```

**å‹•ä½œ**:
- **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰æ™‚**: ç©ºã®ãƒ‡ãƒ¼ã‚¿ã§ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã—ã€é™çš„HTMLãŒç”Ÿæˆã•ã‚Œã‚‹ï¼ˆãƒ€ãƒŸãƒ¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯å®Ÿéš›ã«ã¯å‘¼ã°ã‚Œãªã„ï¼‰
- **æœ¬ç•ªç’°å¢ƒ**: `INTERNAL_API_KEY` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æ­£å¸¸ã«APIã‚’å‘¼ã³å‡ºã™
- **ISR**: ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆ`revalidate: 3600`ï¼‰

**å‚è€ƒæƒ…å ±**:
- [Next.js ISR Guide](https://nextjs.org/docs/app/guides/incremental-static-regeneration)
- [Next.js unstable_cache](https://nextjs.org/docs/app/api-reference/functions/unstable_cache)
- ã“ã®å•é¡Œã«é–¢ã™ã‚‹å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯è¦‹ã¤ã‹ã£ã¦ã„ãªã„ãŸã‚ã€ç‹¬è‡ªã®è§£æ±ºç­–ã‚’å®Ÿè£…

## ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

### 1. GitHub Actions (Repository secrets)
**è¨­å®šå ´æ‰€**: `Settings â†’ Secrets and variables â†’ Actions â†’ Repository secrets`

| å¤‰æ•°å | èª¬æ˜ |
|--------|------|
| `CLOUDFLARE_API_TOKEN` | Cloudflare API ãƒˆãƒ¼ã‚¯ãƒ³ |
| `CLOUDFLARE_ACCOUNT_ID` | Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ID |

### 2. Cloudflare Workers ç’°å¢ƒå¤‰æ•°

#### API Worker (`portfolio-api`)
**è¨­å®šå ´æ‰€**: `Workers & Pages â†’ portfolio-api â†’ Settings â†’ Variables`

| å¤‰æ•°å | ç¨®é¡ | èª¬æ˜ | å€¤ã®ä¾‹ |
|--------|------|------|--------|
| `GITHUB_TOKEN` | Secret | GitHub Personal Access Token | `github_pat_11BIBQZMI0...` |
| `QIITA_TOKEN` | Secret | Qiita API ãƒˆãƒ¼ã‚¯ãƒ³ | `7185fa616ba95039...` |
| `INTERNAL_API_KEY` | Secret | å†…éƒ¨ API èªè¨¼ã‚­ãƒ¼ | `a7dnp4mdwOf5v62G...` |

#### Web Worker (OpenNext)
**è¨­å®šå ´æ‰€**: `Workers & Pages â†’ (Web Workerå) â†’ Settings â†’ Variables`

| å¤‰æ•°å | ç¨®é¡ | èª¬æ˜ | å€¤ã®ä¾‹ |
|--------|------|------|--------|
| `INTERNAL_API_KEY` | Secret | å†…éƒ¨ API èªè¨¼ã‚­ãƒ¼ï¼ˆAPI ã¨åŒã˜å€¤ï¼‰ | `a7dnp4mdwOf5v62G...` |
| `GITHUB_USERNAME` | Variable | GitHub ãƒ¦ãƒ¼ã‚¶ãƒ¼å | `TweeTeaFOX223` |
| `ZENN_USERNAME` | Variable | Zenn ãƒ¦ãƒ¼ã‚¶ãƒ¼å | `tweeteafox300` |
| `NEXT_PUBLIC_BASE_URL` | Variable | ã‚µã‚¤ãƒˆã® URL | `https://t2fox.pages.dev` |

**æ³¨æ„**:
- `INTERNAL_API_KEY` ã¯ API ã¨ Web ã§åŒã˜å€¤ã‚’è¨­å®šã—ã¦ãã ã•ã„
- `Secret` ã¯ãƒã‚¹ã‚¯ã•ã‚Œã€`Variable` ã¯å¹³æ–‡ã§è¡¨ç¤ºã•ã‚Œã¾ã™
- ãƒ“ãƒ«ãƒ‰æ™‚ã¯ç’°å¢ƒå¤‰æ•°ãŒãªãã¦ã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§å‹•ä½œã—ã¾ã™ï¼ˆ`config/index.ts` ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­å®šæ¸ˆã¿ï¼‰

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ (GitHub Actions)

`master` ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

**ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼**:
1. **Turborepoã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å¾©å…ƒ** - é«˜é€Ÿãƒ“ãƒ«ãƒ‰
2. **npmä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«** - `npm ci`
3. **R2ãƒã‚±ãƒƒãƒˆã®ã‚¯ãƒªã‚¢** - ISRã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒªã‚»ãƒƒãƒˆ
4. **Backend Workerã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤** - `portfolio-api`
5. **Frontend Workerã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤** - `home`

### æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Backend
cd apps/api
npm run deploy

# Frontend
cd apps/web
npm run build:worker
npm run deploy
```

## ğŸ› ï¸ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

### å‰ææ¡ä»¶

- Node.js 20.x
- npm 10.x
- Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆWranglerèªè¨¼æ¸ˆã¿ï¼‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yourusername/fox-homepage-mk1.git
cd fox-homepage-mk1

# 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
cd apps/api
cp .dev.vars.example .dev.vars
# .dev.varsã‚’ç·¨é›†ã—ã¦APIãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š

cd ../web
# ç’°å¢ƒå¤‰æ•°ã¯ wrangler.jsonc ã® vars ã«è¨­å®šæ¸ˆã¿
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
# Backend (ã‚¿ãƒ¼ãƒŸãƒŠãƒ«1)
cd apps/api
npm run dev
# â†’ http://localhost:8787

# Frontend (ã‚¿ãƒ¼ãƒŸãƒŠãƒ«2)
cd apps/web
npm run dev
# â†’ http://localhost:3000
```

### ãƒ“ãƒ«ãƒ‰

```bash
# Backend
npm run build --workspace=@my-portfolio/api

# Frontend
npm run build:worker --workspace=@my-portfolio/web
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- **First Contentful Paint**: < 1.5s
- **Time to Interactive**: < 3.0s
- **Lighthouse Score**: 95+

**æœ€é©åŒ–æ–½ç­–**:
- Cloudflare Edge Network ã«ã‚ˆã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡
- ISRã«ã‚ˆã‚‹é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- Service Bindingã«ã‚ˆã‚‹ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼é€šä¿¡
- Turborepoã«ã‚ˆã‚‹é«˜é€Ÿãƒ“ãƒ«ãƒ‰

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

**é–‹ç™ºè€…**: TweeTeaFOX223
**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**: Next.js 16 + Hono.js + Cloudflare Workers
**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: BFF + ISR + Turborepo
